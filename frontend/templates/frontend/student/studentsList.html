{% extends 'frontend/base.html' %}
{% block  title %} Students List {% endblock title %}
{% block  pagetitle %} Students List {% endblock pagetitle %}

{% block  main %} 

<!-- inner-content -->
<div class="inner-content">
    <div class="btns">
        <a href="/addstudent" class="btn btn-sm add-btn text-white mb-2 ml-3">Add Student</a>
        <button onclick ="confirmDownload()" class="btn btn-sm bg-success text-white mb-2 ml-2">Export excel</button>
    </div>
    <!-- Success message after data has been sent  -->
    {% if messages %}
    <ul class="messages">
    {% for message in messages %}
        <div class="alert alert-success alert-dismissible fade show" role="alert" {% if message.tags %} class="{{ message.tags }}"{% endif %}>
          <button type="button" class="close" data-dismiss="alert" aria-label="Close">
            <span aria-hidden="true">&times;</span>
          </button>
          <strong>{{ message }}</strong> 
        </div>
    {% endfor %}
    </ul>
    {% endif %}
    <div class="table-section" style="font-size: 14px;"> 
        
        <table class="table" id="table">
            <thead>
                <tr>
                    <th>Student number</th>
                    <th>Child Fullname</th>
                    <th>Gender</th>
                    <th>Date of Birth</th>
                    <th>Address</th>
                    {% comment %} <th>Class</th> {% endcomment %}
                    <th>Registration Date </th>
                    <th>House</th>
                    <th>Father</th>
                    <th>Mother</th>
                    <th>Actions</th>
                </tr>
            </thead>
            <tbody>
                {% for student in students %}
                <tr>
                    <td>{{ student.stdnumber }}</td>
                    <td>{{ student.childname }}</td>
                    <td>{{ student.gender }}</td>
                    <td>{{ student.dob }}</td>
                    <td>{{ student.address }}</td>
                    {% comment %} <td>{{ student.stdclass }}</td> {% endcomment %}
                    <td>{{ student.regdate }}</td>
                    <td>{{ student.house }}</td>
                    <td>{{ student.fathername }}</td>
                    <td>{{ student.mothername }}</td>
                    <td>
                        
                        <div class="btn-group">
                            <button type="button" class="btn btn-sm btn-primary dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                                Actions
                            </button>
                            <div class="dropdown-menu">
                                <a href="/showstudent/{{student.stdnumber}}" class="dropdown-item">MORE</a>
                                {% comment %} <button class="dropdown-item btn btn-sm btn-danger text-danger" onclick="handleDelete('{{student.stdnumber}}')">DELETE</button> {% endcomment %}
                                <a href="/deletestudent/{{student.stdnumber}}" class="dropdown-item btn btn-sm btn-primary text-danger">DELETE</a>
                                <a href="/editstudent/{{student.stdnumber}}" class="dropdown-item btn btn-sm btn-primary text-primary">EDIT</a>
                            </div>
                        </div>
                    </td>
                </tr>
                
                {% endfor %}  
            </tbody>
        </table>
    </div>
    <!-- student show -->
    <div class="show_student">
        
    </div>
</div>

<!--javascript code to alert the user before exporting the file-->
<script>
    function confirmDownload(){
        if(confirm("Are you sure you want to export the data to an Excel file?")){
            window.location.href = "{% url 'export_excel' %}"
        }
    }
</script>
<!--code that alert before deleting the user-->
{% comment %} <script>
    function handleDelete(stdnumber) {
        if (confirm("Are you sure you want to delete this student?")) {
            window.location.href = "{% url 'deleteStudent' %}"
            
        }
    }
</script> {% endcomment %}
<!-- inner-content -->
{% endblock main %}